<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.petshopuser.mapper.OrderMapper">
    <resultMap id="getOrderByIdDTO" type="com.example.petshopuser.entity.Order">
        <result column="order_id" property="order_id" />
        <result column="commodity_id" property="commodity_id"/>
        <result column="user_id" property="user_id"/>
        <result column="specification" property="specification"/>
        <result column="num" property="num"/>
        <result column="total_price" property="total_price"/>
        <result column="create_time" property="create_time"/>
    </resultMap>
    <select id="getOrderById" resultMap="getOrderByIdDTO">
        SELECT * FROM order_info where order_id = #{order_id}
    </select>
    <resultMap id="getAllStatusByIdDTO" type="com.example.petshopuser.entity.Order_Status">
        <result column="status_id" property="status_id" />
        <result column="order_id" property="order_id"/>
        <result column="status_description" property="status_description"/>
        <result column="create_time" property="create_time"/>
    </resultMap>
    <select id="getAllStatusById" resultMap="getAllStatusByIdDTO">
        select * from order_status where order_id = #{order_id} order by create_time
    </select>

    <insert id="putOrder">
        insert into order_info(order_id,commodity_id,user_id,specification,num,total_price)
        values(#{order_id},#{commodity_id},#{user_id},#{specification},#{num},#{total_price})
    </insert>
    <insert id="putOrderStatus">
        insert into order_status(status_id,order_id,status_description)
        values(#{status_id},#{order_id},#{status_description})
    </insert>
    <resultMap id="findStatusByIdDTO" type="com.example.petshopuser.entity.Status_description">
        <result column="status_description_id" property="status_description_id"/>
        <result column="status_description" property="status_description"/>
    </resultMap>
    <select id="findStatusById" resultMap="findStatusByIdDTO">
        select * from status_description where status_description_id = #{id}
    </select>
    <insert id="putOCS">
        insert into order_commoditys_specifications(id,order_id,commodity_id,specifications,num,price)
        values (#{id},#{order_id},#{commodity_id},#{specifications},#{num},#{price})
    </insert>
    <resultMap id="findOCSByIdDTO" type="com.example.petshopuser.entity.Order_commodity_specification">
        <result column="id" property="id"/>
        <result column="order_id" property="order_id"/>
        <result column="commodity_id" property="commodity_id"/>
        <result column="specifications" property="specifications"/>
        <result column="num" property="num"/>
        <result column="price" property="price"/>
    </resultMap>
    <select id="findOCSByOrderId" resultMap="findOCSByIdDTO">
        select * from order_commoditys_specifications where order_id = #{order_id}
    </select>
</mapper>